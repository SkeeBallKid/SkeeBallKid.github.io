<!Doctype: HTML w/ Processing>

<html>

  <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <title>Processing Demo</title>
      <script type="text/javascript" src="js/processing.js"></script>
  </head>
  
  <body>
    <h1>Granada High Tutorial</h1>
    <p>Processing demo</p>
    
    <script type="text/processing">
    
      int blockx;
int blocky;
int mousexprev;
int mouseyprev;
boolean mousePressedPrev;
boolean test;

boolean grid[][];

int initialx;
int initialy;

boolean hor;
boolean ver;

void setup() {
  size(500, 500);
  blockx=width/8;
  blocky=7*height/8;
  grid = new boolean[6][6];
  test = true;
}

void draw() {
  background(255);

  if (blockx < width/8) {
    blockx=width/8;
  }
  if (blockx > width-width/8) {
    blockx=width-width/8;
  }
  if (blocky < height/8) {
    blocky=height/8;
  }
  if (blocky > height-height/8) {
    blocky=height-height/8;
  }

  fill(255, 0, 0);
  rectMode(CENTER);
  rect(blockx, blocky, width/4, height/4);

  rect(1*width/8, 1*height/8, width/4, height/4);

  println(initialx + "   " + initialy +"   "+mousePressedPrev + "   " + mouseX + "   "+mouseY+"    " + hor + "    " + ver);
}

void mousePressed() {

  if (mousePressedPrev == false) {
    initialx = mouseX;
    initialy = mouseY;
  }



  mousexprev = mouseX;
  mouseyprev = mouseY;

  mousePressedPrev = true;
}

void mouseDragged() {

  if (mousePressedPrev == true && abs(mouseX-initialx) > abs(mouseY-initialy)) {
    hor = true;
    ver = false;
  } else if (mousePressedPrev == true && abs(mouseX-initialx) < abs(mouseY-initialy)) {
    hor = false;
    ver = true;
  }


  if (abs(mouseX-blockx)<width/4 &&  abs(mouseY-blocky) < height/4) {
    if (hor) {
      blockx = blockx+mouseX-mousexprev;
    }
    if (ver) {
      blocky = blocky+mouseY-mouseyprev;
    }

    for (int i = 1; i<6; i++) {
      for (int j = 1; j<6; j++) {

        if (blockx < width/4+width/8 && blockx > width/4 && abs(blocky-height/8) < height/16) {
          blockx = width/4+width/8;
        }

        if (blocky < height/4+height/8 && blocky > height/4 && abs(blockx-width/8) < width/16) {
          blocky = height/4+height/8;
        }
      }
    }
  }


  mouseyprev=mouseY;
  mousexprev=mouseX;
}


void mouseReleased() {

  if (mousePressedPrev) {
    blockx = (((blockx)/(width/4)))*width/4+width/8;


    blocky = (((blocky)/(height/4)))*height/4+width/8;


    if (blockx < width/8) {
      blockx=width/8;
    }
    if (blockx > width-width/8) {
      blockx=width-width/8;
    }
    if (blocky < height/8) {
      blocky=height/8;
    }
    if (blocky > height-height/8) {
      blocky=height-height/8;
    }
  }

  mousePressedPrev = false;
}



    </script>
    <canvas id="sketch" style="border: 1px solid black;"></canvas>
    
  </body>
  
</html>
